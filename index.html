<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Free Games published!!!</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>

    <header>
        <h1>Free games published!!! ðŸ˜€</h1>
    </header>
    <nav>Try games and publish games!</nav>

    <h2>Upload games for other people to try!</h2>
    <input type="file" id="fileInput" accept="*/*">
    <button id="publishButton">Publish</button>

    <h2>Published games by other people</h2>
    <div id="output"></div>

    <script>
        // Function to load published games from localStorage
        function loadPublishedGames() {
            const output = document.getElementById('output');
            output.innerHTML = ''; // Clear existing content
            
            const publishedGames = JSON.parse(localStorage.getItem('publishedGames')) || [];
            publishedGames.forEach((game, index) => {
                const gameDiv = document.createElement('div');
                
                const link = document.createElement('a');
                link.href = game.url;
                link.download = game.name;
                link.textContent = "Download " + game.name;
                
                const deleteButton = document.createElement('button');
                deleteButton.textContent = 'Remove';
                deleteButton.onclick = function() {
                    removeGame(index);
                };

                gameDiv.appendChild(link);
                gameDiv.appendChild(deleteButton);
                output.appendChild(gameDiv);
            });
        }

        function removeGame(index) {
            const publishedGames = JSON.parse(localStorage.getItem('publishedGames')) || [];
            publishedGames.splice(index, 1); // Remove the game at the given index
            localStorage.setItem('publishedGames', JSON.stringify(publishedGames)); // Update localStorage
            loadPublishedGames(); // Refresh the displayed list
        }

        document.getElementById('publishButton').addEventListener('click', async function() {
            var fileInput = document.getElementById('fileInput');

            // Check if a file is selected
            if (fileInput.files.length > 0) {
                var file = fileInput.files[0];
                
                // Create a link element for download
                var link = document.createElement('a');
                link.href = URL.createObjectURL(file);
                link.download = file.name;
                
                // Save the file information to localStorage
                const publishedGames = JSON.parse(localStorage.getItem('publishedGames')) || [];
                publishedGames.push({ name: file.name, url: link.href });
                localStorage.setItem('publishedGames', JSON.stringify(publishedGames));
                
                // Clear the file input after publishing
                fileInput.value = '';

                // Update the output area
                loadPublishedGames();
            } else {
                alert("Please select a file.");
            }
        });

        // Load published games when the page loads
        window.onload = loadPublishedGames;
    </script>

</body>
</html>
